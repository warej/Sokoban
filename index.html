<html>
	<head>
	<title>Sokoban !</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	
	<link rel="stylesheet" type="text/css" href="style.css" />

	<script type="text/javascript" src="./sokoban/sokoban.js" ></script>
	<script type="text/javascript" src="./sokoban/level.js" ></script>
	<script type="text/javascript" src="./sokoban/menu.js" ></script>

	<script type="text/javascript" src="./graphicObjects/crate.js" ></script>

	<script type="text/javascript" src="./lib/glMatrix-0.9.5.min.js" ></script>
	<script type="text/javascript" src="./lib/jquery-1.10.0.min.js" ></script>
	<script type="text/javascript" src="./lib/json.js" ></script>
	<script type="text/javascript" src="./lib/webgl-utils.js" ></script>

	<script type="text/javascript" src="./downloader.js" ></script>
	<script type="text/javascript" src="./init.js" ></script>
	<script type="text/javascript" src="./drawing.js" ></script>
	<script type="text/javascript" src="./main.js" ></script>
	<script type="text/javascript" src="./keyboard.js" ></script>

	<script id="fshader" type="x-shader/x-fragment" >
		precision mediump float;

		varying vec2 vTextureCoord;
		//varying vec3 vTransformedNormal;
		varying vec4 vPosition;

		//uniform bool uUseColorMap;
		//uniform bool uUseSpecularMap;
		//uniform bool uUseLighting;

		//uniform vec3 uAmbientColor;

		//uniform vec3 uPointLightingLocation;
		//uniform vec3 uPointLightingSpecularColor;
		//uniform vec3 uPointLightingDiffuseColor;

		uniform sampler2D uColorMapSampler;
		//uniform sampler2D uSpecularMapSampler;


		void main(void) {
			gl_FragColor = texture2D(uColorMapSampler, vec2(vTextureCoord.s, vTextureCoord.t));
		/*
			vec3 lightWeighting;
			if (!uUseLighting) {
				lightWeighting = vec3(1.0, 1.0, 1.0);
			} else {
				vec3 lightDirection = normalize(uPointLightingLocation - vPosition.xyz);
				vec3 normal = normalize(vTransformedNormal);

				float specularLightWeighting = 0.0;
				float shininess = 32.0;
				if (uUseSpecularMap) {
					shininess = texture2D(uSpecularMapSampler, vec2(vTextureCoord.s, vTextureCoord.t)).r * 255.0;
				}
				if (shininess < 255.0) {
					vec3 eyeDirection = normalize(-vPosition.xyz);
					vec3 reflectionDirection = reflect(-lightDirection, normal);

					specularLightWeighting = pow(max(dot(reflectionDirection, eyeDirection), 0.0), shininess);
				}

				float diffuseLightWeighting = max(dot(normal, lightDirection), 0.0);
				lightWeighting = uAmbientColor
					+ uPointLightingSpecularColor * specularLightWeighting
					+ uPointLightingDiffuseColor * diffuseLightWeighting;
			}

			vec4 fragmentColor;
			if (uUseColorMap) {
				fragmentColor = texture2D(uColorMapSampler, vec2(vTextureCoord.s, vTextureCoord.t));
			} else {
				fragmentColor = vec4(1.0, 1.0, 1.0, 1.0);
			}
			gl_FragColor = vec4(fragmentColor.rgb * lightWeighting, fragmentColor.a);
		/* */
		}
	</script>

	<script id="vshader" type="x-shader/x-vertex" >
		attribute vec3 aVertexPosition;
		//attribute vec3 aVertexNormal;
		attribute vec2 aTextureCoord;

		uniform mat4 uM;
		uniform mat4 uV;
		uniform mat4 uP;
		uniform mat3 uN;

		varying vec2 vTextureCoord;
		//varying vec3 vTransformedNormal;
		varying vec4 vPosition;


		void main(void) {
			vPosition =  uV *uM * vec4(aVertexPosition, 1.0);
			gl_Position = uP * vPosition;
			
			vTextureCoord = aTextureCoord;
			//vTransformedNormal = uNMatrix * aVertexNormal;
		}
	</script>

	</head>

	<body onLoad="main()">
		<div id="gameContener">
			<canvas id="canvas">
				<center> <h1> Failed to load the canvas :( </h1> </center>
			</canvas>
		</div>

		<div id="space">
		</div>

		<div id="optionsContener">
			<h1>Opcje:</h1> <hr />
			
			<div id="konsola1">start</div>
			<div id="konsola2">start</div>
			<div id="konsola3">start</div>
			
			<hr />
			Sterowanie kamerą:<br />
			&nbsp;Obracanie: strzałki<br />
			&nbsp;Ruch: YHGJ<br />
			<br />
			Ruch pionkiem: WSAD
			
		</div>

		<div id="loadingPage">
			<h1>Trwa ładowanie</h1> <br />
			<img src="./img/ajaxSpinner.gif" />
		</div>

	</body>
</html>